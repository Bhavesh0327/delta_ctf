from OraclePublic import encrypt

def encrypt_oracle(plaintext):
    return bytes.fromhex(encrypt(plaintext.encode().hex())['ciphertext'])

def attack(blocksize):
    plaintext = ""
    while True:
        needappend = (blocksize - len(plaintext)%blocksize - 1)*'A'
        if needappend == '':
            needappend = 'A'*blocksize
        data = needappend + plaintext
        samplecipher = encrypt_oracle(needappend)[0:len(data)+1]
        for i in range(32,127):
            blockcipher  = encrypt_oracle(data + chr(i))
            if blockcipher[0:len(data)+1] == samplecipher:
                plaintext+=chr(i)
                break
        if plaintext[-1] == '}':
            break
    return plaintext

print(attack(16))